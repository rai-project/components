{"version":3,"sources":["../../../src/node_modules/components/CodeEditor/index.js"],"names":["CodeEditor","getMode","mode","onChange","console","log","handleSaveIconClick","e","content","editor","_","value","props","onSaveIconClick","handleNewIconClick","onNewIconClick","currentFile","files","codeElement","autofocus","theme","matchTags","bothTags","autoCloseTags","lint","lineNumbers","readOnly","indentUnit","extraKeys","Tab","cm","spaces","Array","getOption","join","replaceSelection","on","fontSize","mainElement","ref","withMenuBar","map","name","uuid","paddingTop","Component","defaultProps","undefined"],"mappings":"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","file":"index.js","sourcesContent":["// @flow\n\nimport { Dropdown, Icon, Menu, Segment } from \"semantic-ui-react\";\nimport { If, Then, Else } from \"react-if\";\n\nimport React from \"react\";\nimport idx from \"idx\";\nimport classNames from \"classnames\";\nimport PropTypes from \"prop-types\";\nimport CodeMirror from \"codemirror\";\nimport { isUndefined, size, keys, head, mapKeys } from \"lodash\";\n\nimport \"codemirror/addon/dialog/dialog\";\nimport \"codemirror/addon/hint/show-hint\";\n\n// eslint-disable-next-line import/no-webpack-loader-syntax\nimport \"codemirror/lib/codemirror.css\";\n// eslint-disable-next-line import/no-webpack-loader-syntax\nimport \"./theme.css\";\n\ntype File = {\n  content: string,\n  uuid: string,\n  createdOn: Date,\n  updatedOn: Date\n};\n\ntype Props = {\n  mode: string,\n  withMenuBar: boolean,\n  currentFile: string,\n  files: { [string]: File },\n  fontSize: number,\n  readOnly: boolean,\n  onNewIconClick: (Event => void) | void,\n  onSaveIconClick: ((Event, string | null | void) => void) | void\n};\n\nclass CodeEditor extends React.Component<Props, Props, void> {\n  codeElement: HTMLDivElement;\n  editor: CodeMirror.Editor;\n  static defaultProps: Props = {\n    mode: \"cuda\",\n    currentFile: \"\",\n    withMenuBar: false,\n    files: {},\n    fontSize: 14,\n    readOnly: false,\n    onNewIconClick: undefined,\n    onSaveIconClick: undefined\n  };\n  getMode = async (mode: string) => {\n    if (!mode) return \"jsx\";\n\n    switch (mode) {\n      case \"cuda\":\n        await import(\"./mode/cuda.js\");\n        return \"text/x-cuda-src\";\n      case \"docker\":\n        await import(\"codemirror/mode/dockerfile/dockerfile.js\");\n        return \"docker\";\n      case \"c\":\n      case \"cpp\":\n        await import(\"codemirror/mode/clike/clike.js\");\n        return mode;\n      case \"css\":\n        await import(\"codemirror/mode/css/css\");\n        return \"css\";\n      case \"html\":\n        await import(\"codemirror/mode/htmlmixed/htmlmixed\");\n        return \"htmlmixed\";\n    }\n\n    return \"jsx\";\n  };\n  onChange = () => {\n    console.log(arguments);\n  };\n  async componentDidMount() {\n    const mode = await this.getMode(this.props.mode);\n    const currentFile =\n      size(this.props.files) === 1 && this.props.currentFile === \"\"\n        ? head(keys(this.props.files))\n        : this.props.currentFile;\n    const value = idx(this.props, _ => _.files[currentFile].content) || \"\";\n    // eslint-disable-next-line new-cap\n    this.editor = CodeMirror(this.codeElement, {\n      value,\n      mode,\n      autofocus: true,\n      theme: \"rai\",\n      matchTags: {\n        bothTags: true\n      },\n      autoCloseTags: true,\n      lint: false,\n      lineNumbers: true,\n      readOnly: this.props.readOnly ? \"nocursor\" : false,\n      indentUnit: 2,\n      extraKeys: {\n        Tab(cm) {\n          const spaces = Array(cm.getOption(\"indentUnit\") + 1).join(\" \");\n\n          cm.replaceSelection(spaces);\n        }\n      }\n    });\n    this.editor.on(\"change\", this.onChange);\n    //   this.codemirror.on('change', this.onCodeChange)\n    //   this.codemirror.on('cursorActivity', this.onCursorChange)\n  }\n  handleSaveIconClick = (e: Event) => {\n    const content = idx(this.editor, _ => _.value);\n    if (this.props.onSaveIconClick) {\n      this.props.onSaveIconClick(e, content);\n    }\n  };\n  handleNewIconClick = (e: Event) => {\n    if (this.props.onNewIconClick) {\n      this.props.onNewIconClick(e);\n    }\n  };\n  render() {\n    const { fontSize } = this.props;\n    const mainElement = (\n      <div\n        ref={ref => (this.codeElement = ref)}\n        className={classNames(\"editor\")}\n      />\n    );\n    if (this.props.withMenuBar === false) {\n      return mainElement;\n    }\n    if (\n      isUndefined(this.props.onNewIconClick) &&\n      isUndefined(this.props.onSaveIconClick) &&\n      size(this.props.files) <= 1\n    ) {\n      return mainElement;\n    }\n\n    return (\n      <div>\n        <Menu attached=\"top\" icon={true}>\n          <If condition={!isUndefined(this.props.onNewIconClick)}>\n            <Then>\n              <Menu.Item name=\"new\" onClick={this.handleNewIconClick}>\n                <Icon name=\"file text outline\" />\n              </Menu.Item>\n            </Then>\n          </If>\n          <If condition={!isUndefined(this.props.onSaveIconClick)}>\n            <Then>\n              <Menu.Item name=\"save\" onClick={this.handleSaveIconClick}>\n                <Icon name=\"save\" />\n              </Menu.Item>\n            </Then>\n          </If>\n          <If condition={size(this.props.files) > 1}>\n            <Then>\n              <Menu.Menu position=\"right\">\n                <Dropdown item simple text=\"Files\">\n                  <Dropdown.Menu>\n                    {keys(this.props.files).map((name: string) => {\n                      return (\n                        <Dropdown.Item\n                          text={name}\n                          key={this.props.files[name].uuid}\n                        />\n                      );\n                    })}\n                  </Dropdown.Menu>\n                </Dropdown>\n              </Menu.Menu>\n            </Then>\n          </If>\n        </Menu>\n\n        <Segment attached=\"bottom\" style={{ paddingTop: 0 }}>\n          {mainElement}\n        </Segment>\n      </div>\n    );\n  }\n}\n\nexport default CodeEditor;\n"]}